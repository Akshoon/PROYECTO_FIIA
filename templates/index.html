<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base de Conciertos - Visualizacion de Eventos Musicales</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/variables.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/graphology@0.25.4/dist/graphology.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/graphology-layout@0.6.1/dist/graphology-layout.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/graphology-layout-forceatlas2@0.10.1/dist/graphology-layout-forceatlas2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sigma@2.4.0/build/sigma.min.js"></script>
</head>

<body>
    <!-- LANDING PAGE -->
    <div class="landing-page" id="landing-page">
        <header class="header">
            <div class="header-content">
                <div class="logo" onclick="showLanding()">
                    <img src="{{ url_for('static', filename='img/logoUAH.png') }}" alt="UAH" class="logo-icon">
                    <div class="logo-text">Base de Conciertos <span>Chile</span></div>
                </div>
                <nav class="nav-links">
                    <a href="#features">Caracteristicas</a>
                    <a href="#data">Datos</a>
                    <a href="http://basedeconciertos.uahurtado.cl:5099/api" target="_blank">API</a>
                    <a href="#" onclick="showApp(); return false;" class="btn btn-primary"
                        style="padding: 10px 20px;">Explorar Grafo</a>
                </nav>
            </div>
        </header>

        <section class="hero">
            <div class="hero-content">
                <h1>Explora la Historia Musical de Chile</h1>
                <p>Visualiza y analiza mas de 50 anos de eventos musicales, compositores, interpretes y obras a traves
                    de grafos interactivos.</p>
                <div class="hero-buttons">
                    <a href="#" onclick="showApp(); return false;" class="btn btn-primary">Explorar Grafo</a>
                    <a href="#features" class="btn btn-secondary">Mas Informacion</a>
                </div>
            </div>
        </section>

        <section class="stats-section">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">10,000+</div>
                    <div class="stat-label">Eventos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">1945-1995</div>
                    <div class="stat-label">Periodo</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">500+</div>
                    <div class="stat-label">Compositores</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">50+</div>
                    <div class="stat-label">Ciudades</div>
                </div>
            </div>
        </section>

        <section class="features-section" id="features">
            <div class="section-title">
                <h2>Caracteristicas</h2>
                <p>Herramientas poderosas para explorar datos musicales historicos</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">G</div>
                    <h3>Visualizacion de Grafos</h3>
                    <p>Explora conexiones entre eventos, compositores, interpretes y obras.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">B</div>
                    <h3>Busqueda Avanzada</h3>
                    <p>Filtra por ano, compositor, participante, obra, ubicacion y mas.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">A</div>
                    <h3>Analisis de Red</h3>
                    <p>Descubre patrones y relaciones en la historia musical chilena.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">API</div>
                    <h3>API REST</h3>
                    <p>Accede a los datos programaticamente con nuestra API publica.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">DB</div>
                    <h3>Cache Local</h3>
                    <p>Los datos se almacenan localmente para acceso rapido.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">R</div>
                    <h3>Diseno Responsivo</h3>
                    <p>Funciona en escritorio, tablet y dispositivos moviles.</p>
                </div>
            </div>
        </section>

        <section class="data-types" id="data">
            <div class="data-types-content">
                <div class="section-title">
                    <h2>Tipos de Datos</h2>
                    <p>Entidades conectadas en nuestra base de datos</p>
                </div>
                <div class="type-list">
                    <div class="type-badge"><span class="type-dot" style="background: #34495e;"></span>Eventos</div>
                    <div class="type-badge"><span class="type-dot" style="background: #7f8c8d;"></span>Obras</div>
                    <div class="type-badge"><span class="type-dot" style="background: #e74c3c;"></span>Compositores
                    </div>
                    <div class="type-badge"><span class="type-dot" style="background: #95a5a6;"></span>Participantes
                    </div>
                    <div class="type-badge"><span class="type-dot" style="background: #bdc3c7;"></span>Ubicaciones</div>
                    <div class="type-badge"><span class="type-dot" style="background: #3498db;"></span>Instrumentos
                    </div>
                    <div class="type-badge"><span class="type-dot" style="background: #9b59b6;"></span>Tipos de Evento
                    </div>
                    <div class="type-badge"><span class="type-dot" style="background: #1abc9c;"></span>Ciclos</div>
                </div>
            </div>
        </section>

        <footer class="footer">
            <p>Proyecto de la <a href="https://www.uahurtado.cl" target="_blank">Universidad Alberto Hurtado</a> - Datos
                de <a href="http://basedeconciertos.uahurtado.cl:5099" target="_blank">Base de Conciertos</a></p>
        </footer>
    </div>

    <!-- APP PAGE -->
    <div class="app-page" id="app-page">
        <header class="app-header">
            <div class="app-logo" onclick="showLanding()">
                <img src="{{ url_for('static', filename='img/logoUAH.png') }}" alt="UAH"
                    style="height: 32px; width: auto;">
                <span style="margin-left: 10px;">Base de Conciertos</span>
            </div>
            <a href="#" onclick="showLanding(); return false;" class="back-btn">Volver al Inicio</a>
        </header>

        <div class="filters-bar">
            <select id="year-select" class="filter-select">
                <option value="">Todos los anos</option>
            </select>
            <input type="text" id="composer-search" class="filter-input" placeholder="Compositor...">
            <input type="text" id="participant-search" class="filter-input" placeholder="Participante...">
            <input type="text" id="piece-search" class="filter-input" placeholder="Obra...">
            <input type="text" id="event-search" class="filter-input" placeholder="Evento...">
            <input type="text" id="location-search" class="filter-input" placeholder="Ubicacion...">
            <input type="text" id="activity-search" class="filter-input" placeholder="Actividad...">
            <select id="gender-select" class="filter-select">
                <option value="">Genero</option>
                <option value="Masculino">Masculino</option>
                <option value="Femenino">Femenino</option>
            </select>
            <select id="limit-select" class="filter-select">
                <option value="100">100</option>
                <option value="200">200</option>
                <option value="500" selected>500</option>
                <option value="1000">1000</option>
                <option value="2000">2000</option>
            </select>
            <button id="load-btn" class="filter-btn filter-btn-primary">Filtrar</button>
            <button id="monthly-btn" class="filter-btn filter-btn-secondary">Cargar Todo</button>
            <button id="clear-btn" class="filter-btn filter-btn-secondary">Limpiar</button>
            <button id="clear-cache-btn" class="filter-btn filter-btn-secondary" style="background: #c0392b;"
                title="Eliminar datos locales">Limpiar Cache</button>
        </div>

        <div class="graph-container">
            <div id="sigma-container"></div>

            <div class="legend-panel">
                <div class="legend-title">Leyenda</div>
                <div class="legend-item"><span class="legend-color"
                        style="background: #FF6B6B"></span><span>Eventos</span></div>
                <div class="legend-item"><span class="legend-color"
                        style="background: #4ECDC4"></span><span>Obras</span></div>
                <div class="legend-item"><span class="legend-color"
                        style="background: #FFE66D"></span><span>Compositores</span></div>
                <div class="legend-item"><span class="legend-color"
                        style="background: #95E1D3"></span><span>Participantes</span></div>
                <div class="legend-item"><span class="legend-color"
                        style="background: #A8E6CF"></span><span>Ciudades</span></div>
                <div class="legend-item"><span class="legend-color"
                        style="background: #FF8B94"></span><span>Instrumentos</span></div>
                <div class="legend-item"><span class="legend-color" style="background: #8B7FFF"></span><span>Tipos de
                        Evento</span></div>
            </div>

            <div class="zoom-controls">
                <button id="zoom-in" class="zoom-btn" title="Acercar">+</button>
                <button id="zoom-out" class="zoom-btn" title="Alejar">-</button>
                <button id="zoom-fit" class="zoom-btn" title="Ajustar">O</button>
            </div>

            <div class="search-box">
                <label for="graph-search-input">Buscar en el Grafo</label>
                <input type="text" id="graph-search-input" placeholder="Escriba para buscar..." autocomplete="off" />
            </div>

            <div class="loading-overlay" id="loading-overlay" style="display: none;">
                <div class="spinner"></div>
                <span>Cargando datos...</span>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/db.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>

    <script>
        function showApp() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('app-page').classList.add('active');
            // Esperar un poco para asegurar que main.js esté completamente inicializado
            setTimeout(function () {
                if (typeof initializeGraph === 'function') {
                    console.log('Calling initializeGraph from showApp...');
                    initializeGraph();
                } else {
                    console.error('initializeGraph not available yet');
                }
            }, 100);
        }
        function showLanding() {
            document.getElementById('landing-page').classList.remove('hidden');
            document.getElementById('app-page').classList.remove('active');
        }

        // Verificar hash después de que todo esté cargado
        if (window.location.hash === '#app') {
            // Esperar a que main.js esté listo
            if (document.readyState === 'complete') {
                showApp();
            } else {
                window.addEventListener('load', function () {
                    showApp();
                });
            }
        }
    </script>
</body>

</html>